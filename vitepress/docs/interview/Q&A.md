# 实习问题
- 背景
- 沟通
- 需求实现

## 解释一下可支持多平台、可拓展、可插拔式架构
	- 目前的业务范围是包括了 h5和 pc端的内容，基于的前端框架也可以不同
	- 然而 h5端目前需要监控的内容所需要的功能没那么多，并且有些监控的功能是需要和 pc端的区分开
		- 比如首屏的判断...使用的这块主要是 pc的，所以其他的没怎么了解
	- 可拓展、可插拔
		- 公共库（生成错误 id等）都继承，这样可以方便维护和统一某些功能
		- 每个平台分开打包，体积减小
		- 每个功能都是一个插件，可以拓展也可以移除（公共的就都已经维护了）
## 首屏渲染时间不准		
- 起了 webwork线程进行渲染
- 首先这些检测网页性能的指标（fp,fcp,lcp,cls）都是 chrome开发团队提出来的，都是可以通过`PerformanceObserver`来获取
- 解决了什么问题
	- 怎么知道`DOM`渲染完毕了？
    	- `MutationObserver`，防抖节省大量资源
	- 为什么`DOM`显示完毕的时间不对？
    	- 和 performance面板的时间比较有细微出入
		- 使用`requestAnimationFrame() `回调函数中调用`performance.now() `获取当前时间，作为它的绘制时间
	- 非首屏的要监控吗？
    	- **开会讨论**
	- 什么时候进行开始执行监听函数？什么时候上报？
    	- **开会讨论**，当初的方案是通过数组储存 DOM修改时间，取最大值即可，考虑优化执行，我们会在 Lcp触发之后再进行触发，减少了函数的执行次数
## 缓存命中率
- performanceObserver可以监听页面加载的资源的信息（resource）、页面的加载和卸载的详细信息（navigation）
- 主要就是去比较每个监听对象的 `transferSize`和 `encodedBodySize`两个字段的值
## FPS的监控
- 实现思路就是通过`requestAnimationFrame()`来统计单位时间内执行多少次来获取的
## 异常隔离
- 先讲到项目架构，每个功能点都有单元测试，并且函数通过` try-catch`包裹，避免了 SDK会出现问题

## 怎么理解**异常隔离、上报优化的降级上报机制和会话级别的错误上报去重**
	- 我们的 SDK是不能出错的，最简单的就是实例化的时候去 `try-catch`包裹
	- 但是我们需要去知道哪个模块出了问题，我们可以在功能函数里去加`try-catch`即可，并且通过 jest用例测评，基本是不会出现拓展后还有发送异常的可能
	- Beacon : **不需要响应**，**不会阻塞**主线程的任务执行，保证页面卸载之前启动请求，适用在一些可以延迟上报的情况（fps、pv、pu）
	- ajax：
	- 实际上就是根据错误堆栈进行解析，可以获取某个 `chunk`下哪`行`的`方法`有问题再根据生成`hash`值，我们要实现同一个用户错误上报一次，不同用户的上报同一个错误需要服务端去根据 `id`处理数据


