# 跨域
**讲一下跨域是啥**
- 跨域本质就是**浏览器**基于**同源策略**的一种安全的手段，跨域是对浏览器的限制。同源策略呢，是浏览器核心的安全功能。
- 同源策略呢，三个相同，协议、主机、端口相同。当有一个不同了，就会产生跨域问题。

**如何解决呢**
- `vue`全栈项目里我是用的最多的是`CORS`跨域
- 只要在`koa`或者`epress`里实现了`cors`，就实现了跨域
- 只要在配置的时候增加一些请求头就可以了
- 比较常见的有
  - Access-Control-Allow-Origin `'host'`可以设置白名单
  - Access-Control-Allow-Headers `'Content-Type, Content-Length, Authorization, Accept, X-Requested-With , yourHeaderFeild'`
  - Access-Control-Allow-Methods `'PUT, POST, GET, DELETE, OPTIONS'`

- 还有就是通过proxy来实现跨域
- 它的本质就是通过绕开浏览器的同源策略限制来实现的
- 一是可以通过`webpack`的`devServer`来配置`proxy`进行代理
- 二是通过`nginx`实现代理

- 还有是一个`html5`原生的`websocket`也可以进行跨域
- `WebSocket` 是一种在单个` TCP `连接上进行双向通信的协议。与 `HTTP` 不同的是，`WebSocket` 在建立连接后，客户端和服务器之间可以直接发送消息，而不需要像 `HTTP` 一样每次请求都需要建立新的连接。
- 要实现 `WebSocket` 跨域服务，要向 `CORS` 一样设置允许特定域名的跨域请求才行

- 最后我还了解了jsonp来实现跨域
- 返回的数据会被当做`JavaScript`代码执行
- 浏览器对于` <script>` 标签的请求不受同源策略限制的特性。
- JSONP只支持`GET`请求，无法支持`POST`等其他类型的请求。
  - jsonp引发的恶意攻击：
  - XXS与CFRS攻击
  - 数据泄漏

# nginx
**讲一下nginx的反向代理**
- 反向代理服务器充当了一个中间人的角色
- 输入网站访问服务器的时候，会先通过http或者https协议发送到反向代理服务器
- nginx根据配置呢，把请求转发到后端服务器上面
- 响应返回给nginx服务器，nginx服务器转发响应给客服端

**负载均衡**
- 定义了后端服务器集群，其中包含多少台Web服务器
- 一个挂了就可以转发给另一个
- 就可以实现负载均衡

# XXS攻击
**讲一下什么是XXS攻击**
- 叫**跨站脚本**攻击
- 分为三种情况
  - **存储型**、**反射型**和**文档型**
- 存储型比较常见的例子就是评论去输入一段脚本代码，没做转义和过滤等操作，就会存储到数据库里，页面渲染过程中直接执行。
- 反射型比较常见的就是脚本代码作为网络请求的一部分，经过服务器，反射到html文档里，执行
- 文档型是在数据传输过程中劫持数据包，修改里面的html文档

**怎么防范XXS攻击呢？**
- 一个信念，两个利用
- 千万不要相信用户的任何输入，必须经过**转义**和**过滤**
- 利用`CSP`安全机制，核心思想就是服务器决定浏览器加载哪些资源
- 利用`HttpOnly`
  - 很多 XSS 攻击脚本都是用来窃取`Cookie`, 而设置 `Cookie` 的 `HttpOnly` 属性后，`JavaScript` 便无法读取 `Cookie` 的值。这样也能很好的防范 `XSS` 攻击。

## CFRS攻击
**讲一下什么是CSRF攻击**
- `即跨站请求伪造`
- 比较常见的有黑客诱导用户点击链接，那么就打开了黑客的网站，黑客就**利用用户目前的登录状态**发起跨站请求
- 然后就可能做下面几件事
- 1是自动发get请求，这个请求会带上之前你已经登录过的网站的cookie，然后进行操作，获取信息、转账汇款
- 2是自动发post请求，写了一个自动提交post请求的脚本，恶意操作
- 3是诱导点击发送get请求，流程大差不大
- CSRF攻击并不需要将恶意代码注入用户当前页面的html文档中，而是跳转到新的页面，**利用`服务器的验证漏洞`和`用户之前的登录状态`来`模拟用户进行操作`。**

**怎么防范CFRS攻击**
1. 利用`Cookie`的`SameSite`属性
   - strict模式，完全禁止第三方请求携带，完全遵守同源策略
   - lax模式，get提交的时候可以携带
   - none模式，自动携带
2. 验证来源站点，请求头中的两个字段，Origin(域名)和Referer(URI)，但是可以伪造啊
3. CSRF Token令牌，在每个表单提交中都包含一个随机生成的令牌




